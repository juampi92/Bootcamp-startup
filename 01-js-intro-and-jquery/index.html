<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>JavaScript Intro and jQuery</title>

	<link rel="stylesheet" href="normalize.css">
	<link rel="stylesheet" href="stylesheet.css">
</head>
<body>

  <h1>JavaScript Intro and jQuery</h1>
  <section class="hello-world" hidden>
  	Hello World
  	<br>
  	<input type="text" class=alias> <button>Go!</button>
  	<div class="response"></div>
  </section>

	
	<script type="text/javascript" src="jquery-2.1.1.min.js"></script>
	<script type="text/javascript">
    $(document).ready(function() {
      var $section = $('section.hello-world'),
      	$input = $($section[0]).find('input.alias'),
      	$button = $($section[0]).find('button'),
      	$response = $($section[0]).find('.response');

      $section.fadeIn("slow",function(){
      	$input.focus();
      });

      $button.on('click',function(){
      	var input = $input.val();

      	$.ajax( "http://bootcamp.aws.af.cm/welcome/" + input )
      		.done( function(data){
      			console.log(data);
      			if ( data.response ) {
      				$response.removeClass('error');
      				$response.html( highlightName( input , data.response ) );
      			} else {

      				// When there is no data.response, the error is handled in a JSON stringified
      				var data = JSON.parse(data);
      				$response.html(data.error);
      				$response.addClass('error');
      			}
      		})
      		.fail( function(e){
      			console.log(e);
      			$response.addClass('error');
      			$response.html(e);
      		});
      });

      function highlightName(name,string){
      	return string.replace(name,'<mark>'+name+'</mark>');
      };

    });
	</script>

</body>
</html>